(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{411:function(s,t,a){s.exports=a.p+"assets/img/env_var.131f17fe.png"},502:function(s,t,a){"use strict";a.r(t);var e=a(5),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"jenkins를-이용하여-상태-모니터링하기"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins를-이용하여-상태-모니터링하기"}},[s._v("#")]),s._v(" Jenkins를 이용하여 상태 모니터링하기")]),s._v(" "),t("p",[s._v("매번하지만 항상 까먹는 젠킨스 설정.")]),s._v(" "),t("p",[s._v("간단하게 젠킨스를 이용해 서비스가 잘 돌아가고 있는지 체크하는 잡을 정리한다.")]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("환경: Jenkins")]),s._v(" "),t("h2",{attrs:{id:"매개-변수"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#매개-변수"}},[s._v("#")]),s._v(" 매개 변수")]),s._v(" "),t("ul",[t("li",[s._v("매개변수로 꺼내놓으면 다른 서비스, 웹사이트 등 하나의 item을 카피해서 변경해주기 쉽다.")]),s._v(" "),t("li",[t("code",[s._v("URL")]),s._v(" : 확인할 URL")]),s._v(" "),t("li",[t("code",[s._v("ATTEMPT")]),s._v(" : 시도 할 숫자")]),s._v(" "),t("li",[t("code",[s._v("TIMEOUT")]),s._v(" : 실패 시, 다시 시도할때까지 기다릴 시간(초)")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(411),alt:""}})]),s._v(" "),t("h2",{attrs:{id:"빌드-유발"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#빌드-유발"}},[s._v("#")]),s._v(" 빌드 유발")]),s._v(" "),t("ul",[t("li",[s._v("Build periodically\n"),t("ul",[t("li",[s._v("매 5분마다.")])])])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("H/5 * * * * \n")])])]),t("h2",{attrs:{id:"build-script"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#build-script"}},[s._v("#")]),s._v(" Build Script")]),s._v(" "),t("p",[s._v("위의 매개 변수를 적용한 코드")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("url")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${URL}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("attempts")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ATTEMPT}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("timeout")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TIMEOUT}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("online")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Checking status of '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$url")]),s._v('."')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v("$attempts"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("code")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sL")]),s._v(" --connect-timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" --max-time "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-w")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%{http_code}'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[s._v("\\\\")]),s._v('n"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$url")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" /dev/null"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$code")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("online")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("break")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$timeout")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$online")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Monitor finished, website is online."')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Build Success")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Monitor failed, website seems to be down."')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Build Failed")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n")])])]),t("h2",{attrs:{id:"빌드-후-조치"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#빌드-후-조치"}},[s._v("#")]),s._v(" 빌드 후 조치")]),s._v(" "),t("ul",[t("li",[s._v("슬랙, 이메일 등 상황에 맞는 알림 시스템과 연결한다.")])]),s._v(" "),t("h2",{attrs:{id:"reference"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[s._v("#")]),s._v(" reference")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.wouterbulten.nl/blog/tech/website-status-monitor-using-jenkins/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Website status monitor using Jenkins"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);