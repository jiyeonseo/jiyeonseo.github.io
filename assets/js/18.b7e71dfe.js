(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{387:function(t,s,a){t.exports=a.p+"assets/img/telegram_bot.5ebda9b2.png"},388:function(t,s,a){t.exports=a.p+"assets/img/azure-telegram-sample-function.e0b15fbc.png"},389:function(t,s,a){t.exports=a.p+"assets/img/azure-telegram-sample.06c88f45.png"},390:function(t,s,a){t.exports=a.p+"assets/img/Telegram_Web.9dd67321.png"},490:function(t,s,a){"use strict";a.r(s);var e=a(5),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"azure-function-telegram-chatbot-만들기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#azure-function-telegram-chatbot-만들기"}},[t._v("#")]),t._v(" Azure Function + Telegram chatbot 만들기")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://hackernoon.com/serverless-telegram-bot-on-aws-lambda-851204d4236c",target:"_blank",rel:"noopener noreferrer"}},[t._v("Serverless Telegram bot on AWS Lambda"),s("OutboundLink")],1),t._v(" 는 AWS 람다 + Python 을 이용하여 텔레그램 봇을 만드는 실습 블로그인데, 읽다가 왠지 조금 다르게 해보고 싶어서 Azure Function + Node 로 살짝 다르게 실습해 보았다.")]),t._v(" "),s("hr"),t._v(" "),s("h1",{attrs:{id:"준비사항"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#준비사항"}},[t._v("#")]),t._v(" 준비사항")]),t._v(" "),s("ul",[s("li",[t._v("Node v6.5.0 이상")]),t._v(" "),s("li",[t._v("MS Azure 계정")]),t._v(" "),s("li",[t._v("텔레그램 계정")])]),t._v(" "),s("h2",{attrs:{id:"_1단계-telegram-bot-생성-및-토큰-받기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1단계-telegram-bot-생성-및-토큰-받기"}},[t._v("#")]),t._v(" 1단계 : Telegram Bot 생성 및 토큰 받기")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://web.telegram.org/#/im?p=@BotFather",target:"_blank",rel:"noopener noreferrer"}},[t._v("@BotFather"),s("OutboundLink")],1),t._v(" 에서 봇을 만든다.")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("/newbot")]),t._v(" : 새로운 봇 생성. 이름은 *_bot 과 같은 형식으로")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(387),alt:""}})]),t._v(" "),s("p",[t._v("마지막에 발급 받은 Token을 나중에 사용한다. 봇 생성 끝!")]),t._v(" "),s("h3",{attrs:{id:"봇과-나의-챗-아이디"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#봇과-나의-챗-아이디"}},[t._v("#")]),t._v(" 봇과 나의 챗 아이디")]),t._v(" "),s("p",[t._v("만약 내 봇과의 대화에서 나에게만 보내고 싶은 정보가 있거나, 나의 채팅방에만 메세지를 전달해야할 때 챗 아이디를 알면 편리하다")]),t._v(" "),s("p",[t._v("내 봇과 아무말을 한 뒤, "),s("code",[t._v("getUpdates")]),t._v("를 이용하면 내 챗 아이디를 찾을 수 있다.")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" https://api.telegram.org/bot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("bot_token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/getUpdates` \n")])])]),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    ok"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    result"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            update_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("79374297")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            message"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                message_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("54")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                from"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" #myid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    is_bot"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    first_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cheese"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    last_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Seo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    language_code"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ko"')]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                chat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1234567890")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// chat_id")]),t._v("\n                    first_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cheese"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    last_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Seo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"private"')]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                date"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1589148395")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                text"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hey"')]),t._v("\n             "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"_2단계-serverless-framework-를-이용한-프로젝트-생성"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2단계-serverless-framework-를-이용한-프로젝트-생성"}},[t._v("#")]),t._v(" 2단계 : Serverless framework 를 이용한 프로젝트 생성")]),t._v(" "),s("p",[t._v("쉽게 사용하고 쉽게 배포할수 있는 "),s("a",{attrs:{href:"https://serverless.com/framework/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Severless framework"),s("OutboundLink")],1),t._v("을 사용하겠다. 이 프레임워크에서는 AWS, Azure 뿐만 아니라 Google cloud 등 "),s("a",{attrs:{href:"https://serverless.com/framework/docs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("다양한 클라우드 프로바이더"),s("OutboundLink")],1),t._v("에 대해 서포트 하고 있으니 원하는 클라우드에 따라서 선택하면 된다. 이번 블로그에서는 Azure function을 사용해 보도록 하겠다.")]),t._v(" "),s("h3",{attrs:{id:"serverless-framework-설치"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#serverless-framework-설치"}},[t._v("#")]),t._v(" Serverless framework 설치")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" serverless\n")])])]),s("h3",{attrs:{id:"새로운-프로젝트-생성"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#새로운-프로젝트-생성"}},[t._v("#")]),t._v(" 새로운 프로젝트 생성")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ serverless create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--template")]),t._v(" azure-nodejs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("path_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("my-unique-name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("새로 생성된 프로젝트 폴더로 들어가면 두 개의 파일이 생성된 것을 볼 수 있다.")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("handler.js")]),t._v(" : node 코드로 된 템플릿")]),t._v(" "),s("li",[s("code",[t._v("serverless.yml")]),t._v(" : 설정 파일")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ cd {path_name}\n$ npm install \n")])])]),s("h2",{attrs:{id:"_3단계-serverless-배포-및-확인"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3단계-serverless-배포-및-확인"}},[t._v("#")]),t._v(" 3단계 : Serverless 배포 및 확인")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ serverless deploy\n")])])]),s("p",[t._v("만약, Azure에 미리 로그인이 되어있지 않다면 로그인 하는 페이지가 열리게 된다.\n그리고 다음과 같이 로깅이 뜨는 걸 볼 수 있다.")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("Serverless: WARNING: Missing "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tenant"')]),t._v(" and "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app"')]),t._v(" properties "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" serverless.yml. Without these properties, you can not publish the "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" to the Serverless Platform.\nServerless: Building Azure Events Hooks\nServerless: Parsing Azure Functions Bindings.json"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nServerless: Building binding "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" function: hello event: httpTrigger\nServerless: Building binding "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" function: hello event: http\nServerless: Packaging service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nServerless: Excluding development dependencies"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nServerless: Logging "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" to Azure\nServerless: Creating resource group: azure-telegram-sample-rg\nServerless: Creating "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" app: azure-telegram-sample\nServerless: Waiting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" Kudu endpoint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nServerless: Uploading function: hello\n")])])]),s("h3",{attrs:{id:"invoking"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#invoking"}},[t._v("#")]),t._v(" invoking")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ serverless invoke "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" hello "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v("\n")])])]),s("h3",{attrs:{id:"log"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#log"}},[t._v("#")]),t._v(" log")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("serverless logs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" hello "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v("\n")])])]),s("p",[s("a",{attrs:{href:"https://portal.azure.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Azure Portal"),s("OutboundLink")],1),t._v(" 에 들어가 Azure Function을 확인하면 새로운 함수 앱과 함수 hello가 생성된 것을 확인 할 수 있다.")]),t._v(" "),s("p",[s("img",{attrs:{src:a(388),alt:""}})]),t._v(" "),s("h2",{attrs:{id:"_4단계-telegram-bot-node-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4단계-telegram-bot-node-js"}},[t._v("#")]),t._v(" 4단계 : Telegram bot (Node.js)")]),t._v(" "),s("p",[t._v("텔레그램 봇 개발을 더 편하게 하기위해 아래 패키지들을 추가로 설치해준다.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ npm install --save node-telegram-bot-api request\n")])])]),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/yagop/node-telegram-bot-api",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("node-telegram-bot-api")]),s("OutboundLink")],1),t._v(" : Telegram Bot API for NodeJS")])]),t._v(" "),s("p",[t._v("위에서 생성된 "),s("code",[t._v("handler.js")]),t._v(" 에 다음 코드를 복사 붙혀넣기 한다")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use strict'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" TelegramBot "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node-telegram-bot-api'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" token "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"YOUR_API_TOKEN"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bot "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TelegramBot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" chatId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" out "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chatId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello World!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// status: 200, /* Defaults to 200 */")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("body")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ok'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n\n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("그리고 배포")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ serverless deploy\n")])])]),s("h2",{attrs:{id:"_5단계-telegram-bot과-연결"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5단계-telegram-bot과-연결"}},[t._v("#")]),t._v(" 5단계 : Telegram bot과 연결")]),t._v(" "),s("p",[t._v('Portal > Function App -> 만든 functionn app -> function "hello"를 들어가면 url end point를 얻을 수 있다.')]),t._v(" "),s("p",[s("img",{attrs:{src:a(389),alt:""}})]),t._v(" "),s("p",[s("code",[t._v("https://api.telegram.org/bot<Your Telegram TOKEN>/setWebhook")]),t._v(" 로\n발급받은 endpoint 를 연결해준다.")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--request")]),t._v(" POST "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--url")]),t._v(" https://api.telegram.org/bot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/setWebhook "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type: application/json'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--data")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"url": "{end-point}"}\'')]),t._v("\n")])])]),s("h2",{attrs:{id:"_6단계-demo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6단계-demo"}},[t._v("#")]),t._v(" 6단계 : demo!")]),t._v(" "),s("p",[t._v("봇에게 말을 걸어보면!")]),t._v(" "),s("p",[s("img",{attrs:{src:a(390),alt:""}})]),t._v(" "),s("p",[t._v("끄읕!")]),t._v(" "),s("h3",{attrs:{id:"소스코드"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#소스코드"}},[t._v("#")]),t._v(" 소스코드")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/jiyeonseo/azure-telegram-sample",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/jiyeonseo/azure-telegram-sample"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"참고-링크들"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#참고-링크들"}},[t._v("#")]),t._v(" 참고 링크들")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://dev.to/lordferquad/telegram-bot-prototype-using-serverless-framework-and-webtask-e7g",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://dev.to/lordferquad/telegram-bot-prototype-using-serverless-framework-and-webtask-e7g"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);